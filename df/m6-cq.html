<!DOCTYPE html><html><head><meta charset="UTF-8"><title>M6: Content Question (procedures )</title><link rel="stylesheet" href="style.css"></head><body><div class="topic"><h1>M6: Content Question (procedures )</h1><div><p><span>Post questions about procedures.</span><span>&nbsp;Use the first line of your post as the subject of the post.</span></p></div></div><table><tbody><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2981551"><tbody><tr><td>dizzy cuckoo posted at 2021-07-20T03:07:50.000Z</td></tr><tr><td><p>The PPT files prof used in the lectures are now available at:</p><p><a href="https://deanza.instructure.com/courses/21014/files" target="_blank" data-api-endpoint="https://deanza.instructure.com/api/v1/courses/21014/folders/root" data-api-returntype="Folder">https://deanza.instructure.com/courses/21014/files</a>. The examples with comments are going to be helpful.&nbsp;</p><p>&nbsp;</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2983571"><tbody><tr><td>consistent centipede posted at 2021-07-21T01:03:11.000Z</td></tr><tr><td><p>Thank you, this was very helpful!</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2983714"><tbody><tr><td>professional pigeon posted at 2021-07-21T02:18:05.000Z</td></tr><tr><td><p>appreciate it</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2991249"><tbody><tr><td>secure salamander posted at 2021-07-23T23:53:42.000Z</td></tr><tr><td><p>Just got around to looking at the examples with comments. That's really going to be helpful. Thank you!</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2994958"><tbody><tr><td>statutory squirrel posted at 2021-07-25T19:40:33.000Z</td></tr><tr><td><p>Thanks a bunch! This is helpful!&nbsp;</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995024"><tbody><tr><td>impressive hummingbird posted at 2021-07-25T20:06:47.000Z</td></tr><tr><td><p>Thanks for posting! Very helpful</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995103"><tbody><tr><td>overseas orca posted at 2021-07-25T20:38:07.000Z</td></tr><tr><td><p>Thanks very much!</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995184"><tbody><tr><td>hilarious harrier posted at 2021-07-25T21:14:46.000Z</td></tr><tr><td><p>Thanks</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995213"><tbody><tr><td>easy dolphin posted at 2021-07-25T21:31:45.000Z</td></tr><tr><td><p>Thank you very much!</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2996119"><tbody><tr><td>enormous earthworm posted at 2021-07-26T02:47:23.000Z</td></tr><tr><td><p>Thanks</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2996648"><tbody><tr><td>breezy bird posted at 2021-07-26T04:33:18.000Z</td></tr><tr><td>Thanks the for the heads up, the comments were definitely helpful.</td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2996818"><tbody><tr><td>civic bovid posted at 2021-07-26T05:05:32.000Z</td></tr><tr><td><p>Thank you for sending the helpful file.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2997241"><tbody><tr><td>thin tick posted at 2021-07-26T06:04:41.000Z</td></tr><tr><td><p>Thanks yimin this was super helpful. I didn't know the powerpoints would be available.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2997558"><tbody><tr><td>agricultural ant posted at 2021-07-26T06:40:03.000Z</td></tr><tr><td><p>Comments were really helpful!</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2983916"><tbody><tr><td>loose llama posted at 2021-07-21T03:44:10.000Z</td></tr><tr><td><p>Chapter 6 feels like learning the Irvine API</p><p>&lt;rant&gt;<br>I know this is just opinion and ranting but I'd much prefer if Irvine32 had only a very small number of simple functions.&nbsp; Do we need color so much in a book on assembly?&nbsp; It feels like a whole book could be written about the Irvine API alone.&nbsp; I'd appreciate it more if we made our own API in assembler.&nbsp; I also think it would be useful to use Visual Studio to make simple callable C functions to do some I/O work then call them from our ASM code.&nbsp; It would be more representative of real work.&nbsp; I know the author spent a lot of time on the API.&nbsp; But I find myself constantly looking up and<em>learning</em>the author's API which I will probably never use again.<br>&lt;/rant&gt;</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2992885"><tbody><tr><td>electoral dragon posted at 2021-07-24T18:07:14.000Z</td></tr><tr><td><p>Dont worry Nick, we are here for you and completely understand and agree with everything you said. We are more than halfway done tho, just need to grind out a few more chapters!</p><p>Also, looking at the positive side of things, it is cool that the textbook has some pretty decent examples of the material and that we can supplement our understanding with articles/videos online.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2992552"><tbody><tr><td>Deleted by passive owl on Jul 24 at 12:10am posted at null</td></tr><tr><td></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2992556"><tbody><tr><td>passive owl posted at 2021-07-24T07:11:10.000Z</td></tr><tr><td><h3>Compare "ret" with "return" of C++</h3><p>Does "ret" do the same thing as the "return" of C++? What is the next step after the "ret"? go back to the main PROC?</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2992848"><tbody><tr><td>loose llama posted at 2021-07-24T17:42:19.000Z</td></tr><tr><td><p>The x86 "ret" is similar to C++ "return" in that it pops the return address off the stack and uses it to return back to the caller.&nbsp; An x86 C++ compiler will [probably depending on optimizations] generate an x86 "ret" when it compiles the C++ "return" state into x86 code.</p><p>But it's important to note that the x86 "ret" doesn't actually return any value to the caller.&nbsp; So it's like a C++ return from a void function.&nbsp; In x86 assembly you can return values by register or pushing them on the stack or by setting a memory variable.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2994930"><tbody><tr><td>envious earwig posted at 2021-07-25T19:22:19.000Z</td></tr><tr><td><p>Hi!</p><p>Here's a helpful link that explains "ret":<a href="https://www.quora.com/What-does-RET-instruction-do-in-assembly-language" target="_blank" class="external" rel="noreferrer noopener"><span>https://www.quora.com/What-does-RET-instruction-do-in-assembly-language</span><span aria-hidden="true" class="ui-icon ui-icon-extlink ui-icon-inline" title="Links to an external site."></span><span class="screenreader-only">&nbsp;(Links to an external site.)</span></a></p><p>Here is another helpful link:<a href="https://tetzank.github.io/posts/return-oriented-programming/" target="_blank" class="external" rel="noreferrer noopener"><span>https://tetzank.github.io/posts/return-oriented-programming/</span><span aria-hidden="true" class="ui-icon ui-icon-extlink ui-icon-inline" title="Links to an external site."></span><span class="screenreader-only">&nbsp;(Links to an external site.)</span></a></p><p>&nbsp;</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2993201"><tbody><tr><td>supposed swordtail posted at 2021-07-24T21:41:20.000Z</td></tr><tr><td><h2>How does stack allocation work on OS level?</h2><p>How does the operating system know where to allocate the stack space? If there are multiple programs running, how does the operating system allocate the stacks such that one program's stack doesn't intersect with another program's stack or with heap memory?</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2993801"><tbody><tr><td>brief bird posted at 2021-07-25T04:01:05.000Z</td></tr><tr><td><p>Hi Ronak! I personally don't know the exact answer to your question but check out this page and hopefully, it'll answer your questions!</p><p>https://icarus.cs.weber.edu/~dab/cs1410/textbook/4.Pointers/memory.html</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2996746"><tbody><tr><td>insufficient junglefowl posted at 2021-07-26T04:51:45.000Z</td></tr><tr><td><p>Check out this link from stack overflow:&nbsp;</p><p><a href="https://stackoverflow.com/questions/556714/how-does-the-stack-work-in-assembly-language" target="_blank" class="external" rel="noreferrer noopener"><span>https://stackoverflow.com/questions/556714/how-does-the-stack-work-in-assembly-language</span><span aria-hidden="true" class="ui-icon ui-icon-extlink ui-icon-inline" title="Links to an external site."></span><span class="screenreader-only">&nbsp;(Links to an external site.)</span></a></p><p>&nbsp;</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2993894"><tbody><tr><td>relaxed python posted at 2021-07-25T04:33:14.000Z</td></tr><tr><td><p><strong>Question with the 5.2.5 EXAMPLE</strong></p><p>ArraySum PROC<br>push esi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; save ESI, ECX<br>push ecx<br>mov eax,0 ; set the sum to zero<br>L1:<br>add eax,[esi]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; add each integer to sum<br>add esi,TYPE DWORD ; point to next integer<br>loop L1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; repeat for array size</p><p>&nbsp;</p><p>I have a question with the code above, I'm wondering why does "add esi, TYPE DWORD" point to the next integer?&nbsp;</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995263"><tbody><tr><td>driving deer posted at 2021-07-25T21:54:51.000Z</td></tr><tr><td><p>Hi Yen-Jung,</p><p>I believe that the array representation in memory has all of the elements/integers together in sequential order. You have the address for the start of the array, which is the first element's address. This code uses the esi register to traverse the array. In this case, the type is DWORD so you need to increment by 4 bytes to get to the next element/integer in the array.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995471"><tbody><tr><td>spatial snipe posted at 2021-07-25T23:34:26.000Z</td></tr><tr><td><p><span>TYPE DWORD returns the size of the DWORD type.&nbsp; &nbsp;Hence,</span></p><p><span>add esi, TYPE DWORD will add esi value by 4, which points to next value in the array of type DWORD&nbsp;</span></p><p>&nbsp;</p><p><span>Additional reference:</span></p><p><span>From Textbook 4.3.4 Section (page no. 11),&nbsp;</span></p><div class="page" title="Page 150"><div class="section"><div class="layoutArea"><div class="column"><p><span>The TYPE operator returns the size, in bytes, of a single element of a variable. For example, the TYPE of a byte equals 1, the TYPE of a word equals 2, the TYPE of a doubleword is 4, and the TYPE of a quadword is 8.</span></p></div></div></div></div></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2994826"><tbody><tr><td>financial fowl posted at 2021-07-25T18:29:43.000Z</td></tr><tr><td><p>I am having some trouble differentiating "POP" and "POPAD." I know how stacks work thanks to java and the ability to code them, however I was wondering if there is a semantic difference between these two keywords. I haven't seen the latter in any other language.&nbsp;</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2994978"><tbody><tr><td>statutory squirrel posted at 2021-07-25T19:49:43.000Z</td></tr><tr><td><p>Pretty sure POPAD means pop all double, which means its like multiple pop statements.&nbsp;</p><p>Here are sources I used:</p><p><a href="http://qcd.phys.cmu.edu/QCDcluster/intel/vtune/reference/vc246.htm" target="_blank" class="external" rel="noreferrer noopener"><span>http://qcd.phys.cmu.edu/QCDcluster/intel/vtune/reference/vc246.htm</span><span aria-hidden="true" class="ui-icon ui-icon-extlink ui-icon-inline" title="Links to an external site."></span><span class="screenreader-only">&nbsp;(Links to an external site.)</span></a></p><p><a href="https://faydoc.tripod.com/cpu/popad.htm" target="_blank" class="external" rel="noreferrer noopener"><span>https://faydoc.tripod.com/cpu/popad.htm</span><span aria-hidden="true" class="ui-icon ui-icon-extlink ui-icon-inline" title="Links to an external site."></span><span class="screenreader-only">&nbsp;(Links to an external site.)</span></a></p><p>&nbsp;</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995056"><tbody><tr><td>spatial snipe posted at 2021-07-25T20:20:48.000Z</td></tr><tr><td><p><strong>TL, DR;</strong></p><p>POP pops value on top of the stack,&nbsp; POPAD pops values in stack into general purpose registers in the order as mentioned in text book,<span style="font-family: inherit; font-size: 1rem;">EAX, ECX, EDX, EBX, ESP (value before executing PUSHAD), EBP, ESI, and EDI</span></p><p><strong>Longer Explanation:</strong></p><p>After reading the text book, I noticed the following distinctions.&nbsp; Regular Stack Abstract Data Type is different from Runtime stack in assembly which is managed by processor directly.&nbsp; In Java and other programming languages, stack generally increments top position when a push operation happens, but runtime stack, top pointer address is decreased. (This is counter intuitive to what we learned earlier)</p><p>Now coming to:</p><p>Push - straight forward operation - pushes given value to runtime stack and decrements ESP&nbsp; (read above why its decremented)</p><p>Pop - again straight forward operation - pops out top of runtime stack and copies to destination and increments ESP</p><p>Before going to PUSHAD, POPAD,&nbsp; &nbsp;looking at PUSHFD (copies from EFLAGS and puts on top of runtime stack), POPFD (takes value at top of runtime stack into EFLAGS register),&nbsp; there will be certain situations, we need to save flags and restore the flag states after an operation is performed.&nbsp; Here think of a situation, you are calling a procedure, you need to store the current flags and when the program execution returns back to calling function, you need to restore the flags and nullify any effects that are resulted by the execution of called procedure.</p><p>Similarly, if you need to save the values all general purpose registers (<span style="font-family: inherit; font-size: 1rem;">EAX, ECX, EDX, EBX, ESP (value before executing PUSHAD), EBP, ESI, and EDI),&nbsp; you can use PUSHAD and when you want to restore previous state, you can call POPAD which restores values from stack into general purpose registers.</span></p><p>It will be interesting to check, how the program behaves when runtime stack is empty and a POPAD is executed.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2996480"><tbody><tr><td>faithful firefly posted at 2021-07-26T04:03:02.000Z</td></tr><tr><td><p>POP pops the value on the top of the stack into a 16 or 32 bit general purpose register of your choice. PUSHAD and POPAD are used for storing and preserving the values of most 32 bit registers when you want to go to another procedure, do something that messes with 32 bit general purpose registers, and then restore (most) of your program state.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2995066"><tbody><tr><td>ugliest trout posted at 2021-07-25T20:23:58.000Z</td></tr><tr><td><p><span style="font-size: 14pt;">POPAD POPFD</span></p><p>I am still confuse about the use of POPAD and POPFD, like what are these two really use for?</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995132"><tbody><tr><td>grumpy haddock posted at 2021-07-25T20:50:29.000Z</td></tr><tr><td><p>Push and POPAD/POPFD are important for saving the information for before and after changes. Like if you making changes to several different registers, using push and popad, you can see the before and after to error check your code.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995860"><tbody><tr><td>puzzled pony posted at 2021-07-26T01:33:04.000Z</td></tr><tr><td><p>This is a good video explaining PUSHF, POPF,PUSHFD and POPFD instructions:</p><p><a href="https://www.youtube.com/watch?v=pgDCEqZQNlU" class="external youtubed" target="_blank" rel="noreferrer noopener"><span>Assembly Language Programming Tutorial - 30 - PUSHF, POPF,PUSHFD and POPFD Instruction - YouTube</span><span aria-hidden="true" class="ui-icon ui-icon-extlink ui-icon-inline" title="Links to an external site."></span><span class="screenreader-only">&nbsp;(Links to an external site.)</span></a><a href="https://www.youtube.com/watch?v=pgDCEqZQNlU" class="youtubed"><img src="/images/play_overlay.png" class="media_comment_thumbnail" style="background-image: url(//img.youtube.com/vi/pgDCEqZQNlU/2.jpg)" alt=""></a></p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2995954"><tbody><tr><td>conceptual catfish posted at 2021-07-26T02:05:51.000Z</td></tr><tr><td><p>I also have this question thank you for asking!</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2995227"><tbody><tr><td>easy dolphin posted at 2021-07-25T21:38:38.000Z</td></tr><tr><td><p>In the 4th video (Defining and Using Procedures, CALL and RET) of the provided lecture material, I don't understand why the program doesn't just end on line 12 (i.e. after blue returns and we move 1 to bx). Instead, it executes blue again and then ends. Please explain this to me. Thank you.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2996421"><tbody><tr><td>Cole Gannon posted at 2021-07-26T03:52:02.000Z</td></tr><tr><td><p>Here is my best guess. I am not very sure about this so if someone is able to find a better answer, please post it.</p><ol><li>mov ax, 1</li><li>go to instruction 4 (blue)</li><li>mov bx, 1</li><li>(blue procedure starts here)</li><li>mov ax, 4</li><li>mov bx, 4</li><li>return back to the previous procedure (line 3)</li></ol><p>Procedures are just abstractions over regular labels. Here's a program that does the same thing as the 4th video without procedures.</p><pre><code>.386
.model flat, stdcall
ExitProcess proto, code: dword

.code
main:
   mov ax, 1
   push main$after_blue
   jmp blue
main$after_blue:
   mov bx, 2
blue:
   mov ax, 4
   mov bx, 4
   pop esi
   jmp esi
_start:
   push _start$after_main
   jmp main
_start$after_main:
   invoke ExitProcess, 0
end _start</code></pre><p>Though that kinda begs the question, doesn't it. Why isn't there a<code>pop esi</code>and then<code>jmp esi</code>in<code>main$after_blue</code>? I have no idea, to be honest. I'll do more investigating</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 80px;" id="entry-2996484"><tbody><tr><td>Cole Gannon posted at 2021-07-26T04:03:47.000Z</td></tr><tr><td><p>The guy in the video decided not to have<code>ret</code>at the end of main for reasons we do not fully understand. See below for code with behavior you'd actually expect because I added<code>ret</code>at the end of main.</p><pre><code>.386
.model flat, stdcall
ExitProcess proto, code: dword

.code
main proc
   mov ax, 1
   call blue
   mov bx, 2
   ret
main endp

blue proc
   mov ax, 4
   mov bx, 4
   ret
blue endp

end main
</code></pre></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2996018"><tbody><tr><td>close buzzard posted at 2021-07-26T02:25:52.000Z</td></tr><tr><td><p>Are nested procedure calls practical in assembly? Like are there use cases where it's better than not using it at all?</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2996217"><tbody><tr><td>surviving takin posted at 2021-07-26T03:07:37.000Z</td></tr><tr><td><p>I feel like we will be learning a way to avoid unnecessary nesting in the coming chapters with Advanced Procedures.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2996117"><tbody><tr><td>entitled earwig posted at 2021-07-26T02:47:19.000Z</td></tr><tr><td><p><strong>Reason for using just pushfd, popfd being error-prone</strong></p><p>In Chapter 5 p.143, the book says that using just pushfd and popfd can be error-prone, and that saving it into a variable is safer, but I didn't really understand why.</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2996315"><tbody><tr><td>advanced anaconda posted at 2021-07-26T03:30:33.000Z</td></tr><tr><td><p>Do push and pop always come in pairs?</p><p>After reading the stack operations, I am just curious about if we need to always use push/pop in pairs. Would a push without a pop cause any trouble in our programing? What if the stack is empty/full?</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2996661"><tbody><tr><td>breezy bird posted at 2021-07-26T04:35:07.000Z</td></tr><tr><td>Hi, I also have the same questions. Would greatly appreciate any help!</td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 40px;" id="entry-2997664"><tbody><tr><td>skilled silkworm posted at 2021-07-26T06:53:10.000Z</td></tr><tr><td><p>Hi Sarah,</p><p>I think push pop is like the two sides of a coin. If there is input there will be output as a result.</p><p>This is where I found some helpful information:</p><p><a class="inline_disabled external" href="https://stackoverflow.com/questions/26026174/how-does-push-and-pop-work-in-assembly" target="_blank" rel="noreferrer noopener"><span>https://stackoverflow.com/questions/26026174/how-does-push-and-pop-work-in-assembly</span><span aria-hidden="true" class="ui-icon ui-icon-extlink ui-icon-inline" title="Links to an external site."></span><span class="screenreader-only">&nbsp;(Links to an external site.)</span></a></p><p>I hope it helps :)</p></td></tr></tbody></table></td></tr><tr><td><table class="comment" style="margin-left: 0px;" id="entry-2997034"><tbody><tr><td>geographical gopher posted at 2021-07-26T05:34:22.000Z</td></tr><tr><td><p>So I have a bit of a silly question, are there any benefits to "losing" your place in the program by manipulating pointers? I don't think there would be any, but maybe it could be an attack vector for some type of attack?</p></td></tr></tbody></table></td></tr></tbody></table></body></html>